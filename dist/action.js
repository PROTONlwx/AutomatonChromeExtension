(()=>{"use strict";var t=function(t,e,n,i){return new(n||(n=Promise))((function(s,o){function c(t){try{r(i.next(t))}catch(t){o(t)}}function l(t){try{r(i.throw(t))}catch(t){o(t)}}function r(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(c,l)}r((i=i.apply(t,e||[])).next())}))};class e{constructor(t){this.actionChain=new i("none",null,null);let e=this.actionChain;for(let i=0;i<t.length;i++){let s=n.objToAction(t[i]);if(s.type.valueOf()=="goto".valueOf()){if(s.gotoStep<0||s.gotoStep>=i)throw"goto invalid steps";e.next=s,s.prev=e,s.next=this.getIthAction(s.gotoStep);break}e.next=s,s.prev=e,e=s}}executeChain(){return t(this,void 0,void 0,(function*(){let t=this.actionChain;for(;null!=t;)yield t.executeAction(),t=t.next}))}getObjRepresentation(){let t=[],e=this.actionChain.next;for(;null!=e;)t.push(e.getObjRepresentation());return t}getIthAction(t){let e=this.actionChain.next,n=0;for(;null!=e;){if(n===t)return e;e=e.next,n++}return null}}class n{static objToAction(t){if("id"in t&&"classList"in t&&!("text"in t))return new s(t.id,t.classList,null,null);if("time"in t)return new o(t.time,null,null);if("gotoStep"in t)return new c(t.gotoStep,null,null);if("pass"in t)return new l(t.pass,null,null);if("id"in t&&"classList"in t&&"text"in t)return new r(t.id,t.classList,t.text,null,null);throw"action type not recognized"}}class i{constructor(t,e,n){this.type=t,this.prev=e,this.next=n}executeAction(){console.log("executeAction not implemented for type: "+this.type)}getObjRepresentation(){return{type:this.type}}}class s extends i{constructor(t,e,n,i){super("click",n,i),this.id=t,this.classList=e}executeAction(){var t;if(document.getElementById(this.id))null===(t=document.getElementById(this.id))||void 0===t||t.click();else{if(""==this.classList)throw"click action id and classlist are null";{let t=document.getElementsByClassName(this.classList)[0];t instanceof HTMLElement?t.click():console.error("Cannot click on selected element.")}}}getObjRepresentation(){return{type:super.getObjRepresentation().type,classList:this.classList,id:this.id}}}class o extends i{constructor(t,e,n){super("wait",e,n),this.time=t}executeAction(){return t(this,void 0,void 0,(function*(){yield new Promise((t=>setTimeout(t,this.time)))}))}getObjRepresentation(){return{type:super.getObjRepresentation().type,time:this.time}}}class c extends i{constructor(t,e,n){super("goto",e,n),this.gotoStep=t}getObjRepresentation(){return{type:super.getObjRepresentation().type,gotoStep:this.gotoStep}}}class l extends i{constructor(t,e,n){super("break",e,n),this.pass=t,this.remaining=t}executeAction(){0==this.remaining--&&(this.next=null)}getObjRepresentation(){return{type:super.getObjRepresentation().type,pass:this.pass}}}class r extends i{constructor(t,e,n,i,s){super("input",i,s),this.id=t,this.classList=e,this.text=n}executeAction(){let t;if(document.getElementById(this.id))t=document.getElementById(this.id);else{if(""==this.classList)throw"click action id and classlist are null";t=document.getElementsByClassName(this.classList)[0]}void 0!==t.value?t.value=this.text:t.innerText=this.text}getObjRepresentation(){return{type:super.getObjRepresentation().type,text:this.text,classList:this.classList,id:this.id}}}chrome.runtime.onMessage.addListener((function(t,n,i){t.request.valueOf()=="actions".valueOf()&&(new e(t.actions).executeChain(),i("Actions executed"))}))})();